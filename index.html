<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JORDAN'S SCHEDULING TERMINAL</title>
    <style>
        /* Terminal-style CSS */
        body {
            background-color: #0c0c0c;
            color: #33ff33;
            font-family: 'Courier New', monospace;
            padding: 20px;
            margin: 0;
        }

        .terminal-header {
            text-align: center;
            font-size: 24px;
            margin-bottom: 30px;
            text-shadow: 0 0 10px #33ff33;
        }

        .section {
            margin-bottom: 30px;
            border: 1px solid #33ff33;
            border-radius: 5px;
            overflow: hidden;
        }

        .section-header {
            background-color: #1a1a1a;
            padding: 10px;
            cursor: pointer;
            user-select: none;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .section-header:hover {
            background-color: #2a2a2a;
        }

        .toggle-icon {
            transition: transform 0.3s;
        }

        .section.collapsed .toggle-icon {
            transform: rotate(-90deg);
        }

        .section-content {
            max-height: 400px; /* Maximum height before scrolling */
            overflow-y: auto;
            overflow-x: auto;
            transition: max-height 0.3s ease-out;
        }

        .section.collapsed .section-content {
            max-height: 0;
            overflow: hidden;
        }

        /* Custom scrollbar styling */
        .section-content::-webkit-scrollbar {
            width: 12px;
            background-color: #1a1a1a;
        }

        .section-content::-webkit-scrollbar-track {
            background-color: #1a1a1a;
            border-left: 1px solid #33ff33;
        }

        .section-content::-webkit-scrollbar-thumb {
            background-color: #33ff33;
            border-radius: 6px;
        }

        .section-content::-webkit-scrollbar-thumb:hover {
            background-color: #66ff66;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            min-width: 600px; /* Ensure table doesn't get too narrow */
        }

        th, td {
            padding: 8px 12px;
            text-align: left;
            border-bottom: 1px solid #1a4d1a;
        }

        th {
            background-color: #1a1a1a;
            position: sticky;
            top: 0;
            z-index: 10;
            font-weight: bold;
            text-transform: uppercase;
        }

        tr:hover {
            background-color: #1a1a1a;
        }

        .loading {
            text-align: center;
            padding: 20px;
            font-style: italic;
        }

        .refresh-status {
            text-align: center;
            margin-top: 20px;
            font-size: 14px;
            opacity: 0.7;
        }

        /* Status colors */
        .status-completed {
            color: #00ff00;
        }

        .status-scheduled {
            color: #ffff00;
        }

        .status-cancelled {
            color: #ff0000;
        }
    </style>
</head>
<body>
    <h1 class="terminal-header">JORDAN'S SCHEDULING TERMINAL</h1>

    <!-- Current & Upcoming Meetings Section -->
    <div class="section" id="current-section">
        <div class="section-header" onclick="toggleSection('current-section')">
            <span>Current & Upcoming Meetings</span>
            <span class="toggle-icon">▼</span>
        </div>
        <div class="section-content">
            <table>
                <thead>
                    <tr>
                        <th>Meeting</th>
                        <th>Status</th>
                        <th>Date</th>
                        <th>Location</th>
                        <th>Notes</th>
                    </tr>
                </thead>
                <tbody id="current-meetings-tbody">
                    <tr>
                        <td colspan="5" class="loading">Loading current meetings...</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- Past Meetings Section -->
    <div class="section" id="past-section">
        <div class="section-header" onclick="toggleSection('past-section')">
            <span>Past Meetings</span>
            <span class="toggle-icon">▼</span>
        </div>
        <div class="section-content">
            <table>
                <thead>
                    <tr>
                        <th>Meeting</th>
                        <th>Status</th>
                        <th>Date</th>
                        <th>Location</th>
                        <th>Notes</th>
                    </tr>
                </thead>
                <tbody id="past-meetings-tbody">
                    <tr>
                        <td colspan="5" class="loading">Loading past meetings...</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <div class="refresh-status" id="refresh-status">Refreshing data...</div>

    <script>
        // Toggle section collapse/expand
        function toggleSection(sectionId) {
            const section = document.getElementById(sectionId);
            section.classList.toggle('collapsed');
        }

        // Google Sheets Configuration
        const SHEET_ID = '16OhRbSJ7weWKebvS8xZzboxohQ3J7VbyZlW13NGIzKU';
        const API_KEY = 'YOUR_API_KEY_HERE'; // You'll need to add your Google Sheets API key
        const SHEET_NAME = 'Sheet1'; // Adjust if your sheet has a different name

        // Function to fetch data from Google Sheets
        async function fetchSheetData() {
            try {
                const url = `https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/${SHEET_NAME}?key=${API_KEY}`;
                const response = await fetch(url);
                const data = await response.json();
                
                if (data.values) {
                    processSheetData(data.values);
                }
            } catch (error) {
                console.error('Error fetching sheet data:', error);
                // For demonstration, using sample data
                useSampleData();
            }
        }

        // Process sheet data and populate tables
        function processSheetData(rows) {
            // Skip header row if present
            const dataRows = rows.slice(1);
            const currentMeetings = [];
            const pastMeetings = [];
            const today = new Date();

            dataRows.forEach(row => {
                const [meeting, status, date, location, notes] = row;
                const meetingDate = new Date(date);
                
                const meetingData = {
                    meeting: meeting || '',
                    status: status || '',
                    date: date || '',
                    location: location || '',
                    notes: notes || ''
                };

                if (meetingDate >= today || status.toLowerCase() === 'scheduled') {
                    currentMeetings.push(meetingData);
                } else {
                    pastMeetings.push(meetingData);
                }
            });

            populateTable('current-meetings-tbody', currentMeetings);
            populateTable('past-meetings-tbody', pastMeetings);
            updateRefreshStatus();
        }

        // Populate table with data
        function populateTable(tbodyId, meetings) {
            const tbody = document.getElementById(tbodyId);
            tbody.innerHTML = '';

            if (meetings.length === 0) {
                tbody.innerHTML = '<tr><td colspan="5" style="text-align: center;">No meetings found</td></tr>';
                return;
            }

            meetings.forEach(meeting => {
                const row = tbody.insertRow();
                row.innerHTML = `
                    <td>${meeting.meeting}</td>
                    <td class="status-${meeting.status.toLowerCase()}">${meeting.status}</td>
                    <td>${meeting.date}</td>
                    <td>${meeting.location}</td>
                    <td>${meeting.notes}</td>
                `;
            });
        }

        // Sample data for demonstration
        function useSampleData() {
            const sampleData = [
                ['Header Row', 'Status', 'Date', 'Location', 'Notes'], // Header
                ['Team Standup', 'Scheduled', '2025-07-20', 'Conference Room A', 'Weekly sync'],
                ['Client Meeting', 'Scheduled', '2025-07-22', 'Zoom', 'Project review'],
                ['Budget Review', 'Scheduled', '2025-07-25', 'Office 302', 'Q3 planning'],
                ['Product Demo', 'Scheduled', '2025-07-28', 'Main Hall', 'New feature showcase'],
                ['Board Meeting', 'Scheduled', '2025-08-01', 'Executive Suite', 'Monthly review'],
                ['Training Session', 'Scheduled', '2025-08-05', 'Training Room', 'New employee onboarding'],
                ['Sales Pitch', 'Scheduled', '2025-08-10', 'Client Office', 'New client acquisition'],
                ['Team Building', 'Scheduled', '2025-08-15', 'Offsite', 'Quarterly event'],
                ['Strategy Meeting', 'Completed', '2025-07-15', 'Conference Room B', 'Q3 strategy discussion'],
                ['Project Kickoff', 'Completed', '2025-07-10', 'Zoom', 'New project launch'],
                ['Design Review', 'Completed', '2025-07-05', 'Design Lab', 'UI/UX review'],
                ['Sprint Planning', 'Completed', '2025-07-01', 'Dev Room', 'Sprint 23 planning'],
                ['Performance Review', 'Completed', '2025-06-28', 'HR Office', 'Mid-year reviews'],
                ['Workshop', 'Cancelled', '2025-06-25', 'Training Center', 'Postponed to next month'],
                ['Conference Call', 'Completed', '2025-06-20', 'Remote', 'Partner discussion']
            ];
            
            processSheetData(sampleData);
        }

        // Update refresh status
        function updateRefreshStatus() {
            const status = document.getElementById('refresh-status');
            const now = new Date();
            status.textContent = `Last updated: ${now.toLocaleString()}`;
        }

        // Auto-refresh every 5 minutes
        function startAutoRefresh() {
            fetchSheetData();
            setInterval(fetchSheetData, 5 * 60 * 1000); // 5 minutes
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', () => {
            startAutoRefresh();
        });
    </script>
</body>
</html>
